<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chandrayaan-3 Orbit Visualization</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="container"></div>

    <div id="legend-panel">
        <h3 onclick="toggleLegend()" style="cursor: pointer;">Legend <span id="legend-toggle">â–¼</span></h3>
        <div id="legend-content">
            <div class="legend-section">
                <strong>Axes:</strong>
                <span class="legend-item"><span class="legend-color" style="background-color: #ff0000;"></span> X-Axis (â™ˆï¸Ž RA=0Â°)</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #00ff00;"></span> Y-Axis (RA=90Â°)</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #0000ff;"></span> Z-Axis (North Pole)</span>
            </div>
            <div class="legend-section">
                <strong>Reference:</strong>
                <span class="legend-item"><span class="legend-color" style="background-color: #ffffff;"></span> Equator</span>
            </div>
            <div class="legend-section">
                <strong>Lunar Orbit:</strong>
                <span class="legend-item"><span class="legend-color" style="background-color: #ff00ff;"></span> Orbital Plane</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #00ffff;"></span> Ascending Node</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #ff8800;"></span> Descending Node</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #aaaaaa;"></span> Moon</span>
            </div>
            <div class="legend-section">
                <strong>Chandrayaan Orbit:</strong>
                <span class="legend-item"><span class="legend-color" style="background-color: #ffff00;"></span> Orbital Plane</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #ffa500;"></span> Orbit Path</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #88ff88;"></span> Ascending Node</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #ff88ff;"></span> Descending Node</span>
                <span class="legend-item"><span class="legend-color" style="background-color: #ffffff;"></span> Spacecraft</span>
            </div>
        </div>
    </div>

    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.152.2/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.152.2/examples/jsm/",
            "astronomy-engine": "https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/+esm"
        }
    }
    </script>

    <div id="launch-popup" style="display: none;">
        <div id="launch-popup-content">
            <h3>Launch Parameters</h3>
            <button id="close-launch-popup" class="close-btn">âœ•</button>

            <div class="launch-param-row">
                <label for="launch-date">Launch Date/Time:</label>
                <input type="datetime-local" id="launch-date" />
            </div>

            <div class="launch-param-row">
                <label for="launch-inclination">Inclination:</label>
                <select id="launch-inclination">
                    <option value="21.5">21.5Â°</option>
                    <option value="41.8">41.8Â°</option>
                </select>
            </div>

            <div class="launch-param-row">
                <label for="launch-omega">Argument of Periapsis (Ï‰):</label>
                <select id="launch-omega">
                    <option value="178">178Â°</option>
                </select>
            </div>

            <div class="launch-param-row">
                <label for="launch-raan">RAAN (Î©):</label>
                <input type="number" id="launch-raan" min="0" max="360" step="0.1" value="0" />
                <span>Â°</span>
            </div>

            <div class="launch-param-row">
                <label for="launch-perigee">Perigee Altitude:</label>
                <input type="number" id="launch-perigee" min="180" max="600000" step="10" value="180" />
                <span>km</span>
            </div>

            <div class="launch-param-row">
                <label for="launch-apogee">Apogee Altitude:</label>
                <input type="number" id="launch-apogee" min="180" max="600000" step="100" value="384400" />
                <span>km</span>
            </div>

            <div class="launch-param-row">
                <label>Orbital Period:</label>
                <span id="launch-period-display">--</span>
            </div>

            <div class="launch-buttons">
                <button id="save-launch-btn" class="primary-btn">Save Launch</button>
                <button id="delete-launch-btn" class="danger-btn" style="display: none;">Delete Launch</button>
            </div>
        </div>
    </div>

    <div id="timeline-panel" class="disabled">
        <div id="timeline-mode-message">Switch to Real mode to use timeline</div>
        <div id="timeline-controls">
            <!-- Top row: Start time | Current time + countdown | Timeline slider -->
            <div class="timeline-row timeline-row-top">
                <input type="datetime-local" id="start-date" title="Start Date/Time" />
                <div id="date-display-column">
                    <div id="current-date"></div>
                    <div id="countdown-timer" style="display: none;"></div>
                </div>
                <div id="timeline-wrapper">
                    <input type="range" id="timeline-slider" min="0" max="90" value="0" step="0.1" />
                    <div id="launch-marker" style="display: none;"></div>
                </div>
            </div>
            <!-- Bottom row: Buttons (center aligned) + Speed -->
            <div class="timeline-row timeline-row-buttons">
                <div id="timeline-buttons-group">
                    <button id="play-pause-btn">â–¶ Play</button>
                    <button id="reset-btn">â†º Reset</button>
                    <button id="add-launch-btn">ðŸš€ Add Launch</button>
                    <div id="speed-controls">
                        <button id="speed-down-btn" title="Decrease speed">â—„</button>
                        <select id="playback-speed">
                            <option value="5">5 days/sec</option>
                            <option value="2">2 days/sec</option>
                            <option value="1">1 day/sec</option>
                            <option value="0.5">12 hr/sec</option>
                            <option value="0.25" selected>6 hr/sec</option>
                            <option value="0.125">3 hr/sec</option>
                            <option value="0.041667">1 hr/sec</option>
                            <option value="0.020833">30 min/sec</option>
                            <option value="0.006944">10 min/sec</option>
                            <option value="0.000694">1 min/sec</option>
                            <option value="0.000011574">Realtime</option>
                        </select>
                        <button id="speed-up-btn" title="Increase speed">â–º</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
    <script>
        function toggleLegend() {
            const content = document.getElementById('legend-content');
            const toggle = document.getElementById('legend-toggle');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = 'â–¼';
            } else {
                content.style.display = 'none';
                toggle.textContent = 'â–¶';
            }
        }
    </script>
</body>
</html>
